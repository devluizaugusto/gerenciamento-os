-- Script de criação do banco de dados
-- Execute este script no MySQL antes de iniciar o servidor

CREATE DATABASE IF NOT EXISTS sistema_ordem_servico CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

USE sistema_ordem_servico;

CREATE TABLE IF NOT EXISTS ordem_servico (
  id INT AUTO_INCREMENT PRIMARY KEY,
  numero_os INT NOT NULL UNIQUE,
  solicitante VARCHAR(255) NOT NULL,
  ubs VARCHAR(255) NOT NULL,
  setor VARCHAR(255) NOT NULL,
  descricao_problema TEXT NOT NULL,
  data_abertura DATE NOT NULL,
  servico_realizado TEXT,
  status ENUM('aberto', 'em_andamento', 'finalizado') DEFAULT 'aberto',
  data_fechamento DATE,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  INDEX idx_status (status),
  INDEX idx_numero_os (numero_os),
  CONSTRAINT chk_numero_os_positive CHECK (numero_os > 0)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Dados de exemplo (opcional)
INSERT INTO ordem_servico 
(numero_os, solicitante, ubs, setor, descricao_problema, data_abertura, servico_realizado, status, data_fechamento) 
VALUES 
(1001, 'KAREN', 'POLICLINICA', 'USG', 'CABEAMENTO E INSTALAÇÃO E CONFIGURAÇÃO DE ROTEADOR', '2026-01-05', 'CABEAMENTO E INSTALAÇÃO E CONFIGURAÇÃO DE ROTEADOR', 'finalizado', '2026-01-05'),
(1002, 'REBECA', 'JUA', 'DENTISTA', 'PORTAS USB DO COMPUTADOR COM MAL FUNCIONAMENTO', '2026-01-05', 'LIMPEZA DAS PORTAS USB', 'finalizado', '2026-01-05'),
(1003, 'EWANDRO', 'LABORATÓRIO', 'RECEPÇÃO', 'IMPRESSORAS DESCONFIGURADAS DO COMPUTADOR', '2026-01-05', 'RECONFIGURAÇÃO DAS IMPRESSORAS', 'finalizado', '2026-01-05'),
(1004, 'FLAVIA', 'CAF', 'RECEPÇÃO', 'MINI-PC DESLIGADO E DESCONFIGURADO DO SISTEMA DE RETIRADA DE SENHAS', '2026-01-05', 'REINICIALIZAÇAO DO MINI-PC E RECONFIGURAÇÃO DO SISTEMA DE RETIRADA DE SENHAS', 'finalizado', '2026-01-05'),
(1005, 'THUANY', 'SANTANA', 'ENFERMEIRA', 'IMPRESSORA SEM SAIR A COR PRETA', '2026-01-06', 'DESOBSTRUÇÃO DO AR DO COMPARTIMENTO DE TINTA', 'finalizado', '2026-01-06'),
(1006, 'GINA', 'VISA', 'SALA ADM', 'IMPRESSORA TRAVADA', '2026-01-06', 'RESET DA IMPRESSORA', 'finalizado', '2026-01-06'),
(1007, 'DRA GISELE', 'SANTA CRUZ', 'MEDICO', 'WORD DESATIVADO E TRAVANDO', '2026-01-05', 'REATIVAÇÃO DO WORD', 'finalizado', '2026-01-05'),
(1008, 'MARGARETH', 'SANTANA', 'MEDICO', 'COMPUTADOR COM ATRASO DE HORA', '2026-01-06', 'TROCA DA PILHA', 'finalizado', '2026-01-06'),
(1009, 'FRANCINEIDE', 'LAGOA AZUL', 'VACINA', 'COMPUTADOR BIPANDO E SEM IMAGEM', '2026-01-06', 'LIMPEZA DA MEMORIA', 'finalizado', '2026-01-06'),
(1010, 'POLIANA', 'SANTO ANTONIO', 'ENFERMEIRA', 'COMPUTADOR SEM LIGAR, FONTE QUEIMADA', '2026-01-06', 'TROCA DA FONTE', 'finalizado', '2026-01-06'),
(1011, 'ALINE', 'CAPS', 'SALA ADM', 'COMPUTADOR SEM IMAGEM', '2026-01-06', 'LIMPEZA DA MEMORIA', 'finalizado', '2026-01-06'),
(1012, 'FAGNER', 'MENDES', 'MEDICO', 'CONFIGURAÇÃO DA IMPRESSORA NA REDE', '2026-01-06', 'CONFIGURAÇÃO DA IMPRESSORA NA REDE', 'finalizado', '2026-01-07'),
(1013, 'LARISSA', 'SANTANA', 'ENFERMEIRA', 'INSTALAÇÃO E CONFIGURAÇÃO DA IMPRESSORA', '2026-01-06', 'INSTALAÇÃO E CONFIGURAÇÃO DA IMPRESSORA', 'finalizado', '2026-01-07'),
(1014, 'PAULA KARINE', 'SEDE DA SECRETARIA', 'VACINA', 'INSTALAÇÃO E CONFIGURAÇÃO DA IMPRESSORA', '2026-01-06', 'INSTALAÇÃO E CONFIGURAÇÃO DA IMPRESSORA', 'finalizado', '2026-01-07'),
(1015, 'MARGARETH', 'SANTANA', 'MEDICO', 'IMPRESSORA COM POUCA TINTA PRETA', '2026-01-06', 'RECARGA DA TINTA PRETA', 'finalizado', '2026-01-07'),
(1016, 'JEANDERSON', 'VIGILANCIA AMBIENTAL', 'SALA ADM', 'COMPUTADOR SEM IMAGEM', '2026-01-07', 'LIMPEZA DA MEMORIA', 'finalizado', '2026-01-07'),
(1017, 'LAUDICEIA', 'ALEGRIA', 'VACINA', 'PREDIO SEM FUNCIONAR INTERNET', '2026-01-08', 'RELIGAÇÃO DO ESTABILIZADOR QUE CONTROLA A ONU E SWITCH', 'finalizado', '2026-01-08'),
(1018, 'ANA KARLA', 'SEDE DA SECRETARIA', 'ATENÇÃO BÁSICA', 'COMPUTADOR COM TELA AZUL E SEM INCIAR O SISTEMA', '2026-01-08', 'REINICIALIZAÇÃO DO SISTEMA DA BIOS', 'finalizado', '2026-01-08'),
(1019, 'NILDA', 'CAF', 'RECEPÇÃO', 'SISTEMA SMARTLINE SEM FUNCIONAR', '2026-01-08', 'REINICIALIZAÇÃO DO SERVIDOR', 'finalizado', '2026-01-08'),
(1020, 'PALOMA', 'URUCUBA', 'ENFERMEIRA', 'TROCA DA IMPRESSORA SAMSUNG POR EPSON', '2026-01-08', 'INSTALAÇÃO E CONFIGURAÇÃO DA IMPRESSORA', 'finalizado', '2026-01-08'),
(1021, 'PALOMA', 'URUCUBA', 'DENTISTA', 'INSTALAÇÃO E CONFIGURAÇÃO DA IMPRESSORA SAMSUNG', '2026-01-08', 'INSTALAÇÃO E CONFIGURAÇÃO DA IMPRESSORA SAMSUNG', 'finalizado', '2026-01-08'),
(1022, 'JESONIAS', 'REDENTOR', 'MEDICO', 'IMPRESSORA COM POUCA TINTA', '2026-01-08', 'RECARGA DA TINTA', 'finalizado', '2026-01-08'),
(1023, 'AMANDA', 'REDENTOR', 'ENFERMEIRA', 'IMPRESSORA COM POUCA TINTA', '2026-01-08', 'RECARGA DA TINTA', 'finalizado', '2026-01-08'),
(1024, 'IDILEIDE', 'SANTA TEREZINHA', 'ENFERMEIRA', 'INSTALAÇÃO E CONFIGURAÇÃO DE IMPRESSORA EPSON', '2026-01-09', 'INSTALAÇÃO E CONFIGURAÇÃO DE IMPRESSORA', 'finalizado', '2026-01-09'),
(1025, 'SILVIA', 'SANTA TEREZINHA', 'ENFERMEIRA', 'INSTALAÇÃO E CONFIGURAÇÃO DE IMPRESSORA EPSON', '2026-01-09', 'INSTALAÇÃO E CONFIGURAÇÃO DE IMPRESSORA', 'finalizado', '2026-01-09'),
(1026, 'VIVIAN', 'SANTA TEREZINHA', 'DENTISTA', 'INSTALAÇÃO E CONFIGURAÇÃO DE IMPRESSORA SAMSUNG', '2026-01-09', 'INSTALAÇÃO E CONFIGURAÇÃO DE IMPRESSORA SAMSUNG', 'finalizado', '2026-01-09');
